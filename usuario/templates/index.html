{% extends 'general/inicio.html' %}
{% load crispy_forms_tags %}
{% load static %}

{% block title %}
Pure Beauty
{% endblock title %}

  
{% block content %}

<header>
      <!-- Carousel -->
<div class="container">
  <div class="row">
    <div class="col-sm-12">
      <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel" >
        <ol class="carousel-indicators">
          <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
          <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
          <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner">
          <div class="carousel-item active">
            <img src="{% static 'images/img1.png' %}" class="d-block w-100" alt="..." width="620px" height="450px">
          </div>
          <div class="carousel-item">
            <img src="{% static 'images/img2.png' %}" class="d-block w-100" alt="..." width="620px" height="450px">
          </div>
          <div class="carousel-item">
            <img src="{% static 'images/img3.png' %}" class="d-block w-100" alt="..." width="620px" height="450px">
          </div>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden"></span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden"></span>
        </a>
      </div>
    
    </div>
  
  </div>

</div>

<!-- Carousel -->
</header>
<!-- Products -->
<section>
  <div class="container my-5">
    <header class="mb-4">
      <h3>Productos nuevos</h3>
    </header>

    <div class="row">
      <!-- Iteración sobre los productos recientes -->
      {% for product in productos_recientes %}
      <div class="col-lg-3 col-md-6 col-sm-5 d-flex">
        <div class="card w-100 my-2 shadow-2-strong">
          <a href="{% url 'usuario:detalle_producto' product.id %}">
            <img src="{{ product.imagen.url }}" class="card-img-top" style="aspect-ratio: 1 / 1" />
          </a>
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">{{ product.nombre }}</h5>
            <p class="card-text">{{ product.precio_act }}</p>
            <a href="#!" class="btn btn-light border px-2 pt-2 icon-hover add-to-wishlist"
              data-product-id="{{ product.id }}">
              <i class="fas fa-heart fa-lg px-1" style="color: rgb(105, 105, 105);"></i>
            </a>
          </div>
        </div>
      </div>
      {% endfor %}
      <!-- Fin de la iteración -->
    </div>
  </div>
</section>
<!-- Products -->

<script>
  $(document).ready(function () {
    // Función para manejar el evento de clic en el botón de la lista de deseos
    $('.add-to-wishlist').on('click', function (e) {
      e.preventDefault();
      var productId = $(this).data('product-id');
      var btn = $(this); // Guardamos una referencia al botón
  
      // Realizar una solicitud AJAX para agregar o quitar el producto de la lista de deseos
      $.ajax({
        type: 'GET',
        url: '/agregar-a-lista-deseos/' + productId + '/',
        success: function (response) {
          if (!response.success) {
            alert(response.message);
          } else {
            // Mostrar mensaje de éxito si es necesario
            if (response.success) {
              $('#success-message').text(response.message).show();
            }
          }
        },
        error: function (xhr, status, error) {
          console.error(error);
        }
      });
    });
  });
</script>

<div id="success-message" style="display: none; padding: 10px; background-color: #d4edda; border-color: #c3e6cb;
  color: #155724; margin-bottom: 15px; border-radius: .25rem; border: 1px solid transparent;"></div>
{% endblock content %}